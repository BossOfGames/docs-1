"use strict";(self.webpackChunkphpvms_docs=self.webpackChunkphpvms_docs||[]).push([[5485],{4137:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>m});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var c=a.createContext({}),s=function(e){var t=a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},p=function(e){var t=s(e.components);return a.createElement(c.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},f=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,c=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),u=s(n),f=i,m=u["".concat(c,".").concat(f)]||u[f]||d[f]||o;return n?a.createElement(m,r(r({ref:t},p),{},{components:n})):a.createElement(m,r({ref:t},p))}));function m(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,r=new Array(o);r[0]=f;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l[u]="string"==typeof e?e:i,r[1]=l;for(var s=2;s<o;s++)r[s]=n[s];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}f.displayName="MDXCreateElement"},450:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>r,default:()=>d,frontMatter:()=>o,metadata:()=>l,toc:()=>s});var a=n(7462),i=(n(7294),n(4137));const o={id:"backups",title:"Backups",sidebar_title:"Backups"},r=void 0,l={unversionedId:"config/backups",id:"config/backups",title:"Backups",description:"phpVMS uses spatie/laravel-backup to perform backups. By default, this feature is disabled, but you can activate it if you want to create backups of your files and database.",source:"@site/docs/config/backups.mdx",sourceDirName:"config",slug:"/config/backups",permalink:"/config/backups",draft:!1,editUrl:"https://github.com/phpvms/docs/tree/master/docs/config/backups.mdx",tags:[],version:"current",frontMatter:{id:"backups",title:"Backups",sidebar_title:"Backups"},sidebar:"docs",previous:{title:"Notifications",permalink:"/config/notifications"},next:{title:"Discord",permalink:"/oauth/discord"}},c={},s=[{value:"Basic Configuration",id:"basic-configuration",level:2},{value:"Advanced Configuration",id:"advanced-configuration",level:2},{value:"Notifications",id:"notifications",level:3},{value:"Disks",id:"disks",level:3},{value:"Backup Retention Configuration",id:"backup-retention-configuration",level:3},{value:"Encryption",id:"encryption",level:3}],p={toc:s},u="wrapper";function d(e){let{components:t,...n}=e;return(0,i.kt)(u,(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"phpVMS uses ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/spatie/laravel-backup"},(0,i.kt)("inlineCode",{parentName:"a"},"spatie/laravel-backup"))," to perform backups. By default, this feature is disabled, but you can activate it if you want to create backups of your files and database."),(0,i.kt)("p",null,"Backups are scheduled nightly, and an older backup is removed, ensuring you have multiple backups available (e.g., last night's, the one before, etc.)."),(0,i.kt)("admonition",{type:"caution"},(0,i.kt)("p",{parentName:"admonition"}," Backups can consume up to 5GB of disk space.")),(0,i.kt)("h2",{id:"basic-configuration"},"Basic Configuration"),(0,i.kt)("p",null,"With this configuration, a backup will be added to the ",(0,i.kt)("inlineCode",{parentName:"p"},"storage/app/{yourApplicationName}")," folder every day. You will receive a notification in case of failure at the email address you specify."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell",metastring:'title=".env"',title:'".env"'},"BACKUP_ENABLED=true\nBACKUP_NOTIFICATION_MAIL_TO=yourEmail@example.com\n")),(0,i.kt)("p",null,"For this feature to work, you need to have email configured (see ",(0,i.kt)("a",{parentName:"p",href:"/config/email"},"here"),")."),(0,i.kt)("h2",{id:"advanced-configuration"},"Advanced Configuration"),(0,i.kt)("h3",{id:"notifications"},"Notifications"),(0,i.kt)("p",null,"By default, only failure notifications are sent via email. You can choose to receive success notifications as well and send them to Discord."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell",metastring:'title=".env"',title:'".env"'},"BACKUP_FAILED_NOTIFICATIONS_CHANNELS=mail\nBACKUP_SUCCEED_NOTIFICATIONS_CHANNELS=mail,discord\nBACKUP_NOTIFICATIONS_MAIL_TO=yourEmail@example.com\nBACKUP_DISCORD_WEBHOOK_URL=https://discord.com/api/webhooks/...\n")),(0,i.kt)("p",null,"If you choose the ",(0,i.kt)("inlineCode",{parentName:"p"},"mail")," channel, you need to configure ",(0,i.kt)("inlineCode",{parentName:"p"},"BACKUP_NOTIFICATIONS_MAIL_TO")," with the email where you want to receive notifications."),(0,i.kt)("p",null,"If you choose the ",(0,i.kt)("inlineCode",{parentName:"p"},"discord")," channel, you need to configure ",(0,i.kt)("inlineCode",{parentName:"p"},"BACKUP_DISCORD_WEBHOOK_URL")," with the webhook URL where you want to receive notifications. See ",(0,i.kt)("a",{parentName:"p",href:"/config/notifications#discord"},"here")," to create a webhook."),(0,i.kt)("h3",{id:"disks"},"Disks"),(0,i.kt)("p",null,"By default, backups are only made on the local disk corresponding to the ",(0,i.kt)("inlineCode",{parentName:"p"},"/storage/app/{yourApplicationName}")," folder. You can add other disks to send your backups."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell",metastring:'title=".env"',title:'".env"'},"BACKUP_DISKS=local,remote\n")),(0,i.kt)("p",null,"To add a new disk, you must create it in ",(0,i.kt)("inlineCode",{parentName:"p"},"config/filesystems.php"),". Examples of configuring disks can be found ",(0,i.kt)("a",{parentName:"p",href:"https://laravel.com/docs/10.x/filesystem#driver-prerequisites"},"here")," and other places online."),(0,i.kt)("h3",{id:"backup-retention-configuration"},"Backup Retention Configuration"),(0,i.kt)("p",null,"By default, phpVMS keeps backups for the last 7 days and retains a maximum of 5000 MB of backup data. You can adjust these settings to customize the retention period and maximum size."),(0,i.kt)("p",null,"To change the number of days for which backups are kept, set the ",(0,i.kt)("inlineCode",{parentName:"p"},"BACKUP_MAX_DAYS")," variable in your ",(0,i.kt)("inlineCode",{parentName:"p"},".env")," file. For example, to keep backups for 3 days, add the following line:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell",metastring:'title=".env"',title:'".env"'},"BACKUP_MAX_DAYS=3\n")),(0,i.kt)("p",null,"To change the maximum size of backups retained, set the ",(0,i.kt)("inlineCode",{parentName:"p"},"BACKUP_MAX_SIZE")," variable in your ",(0,i.kt)("inlineCode",{parentName:"p"},".env")," file. The size is specified in megabytes. For example, to retain backups up to 10000 MB in size, add the following line:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell",metastring:'title=".env"',title:'".env"'},"BACKUP_MAX_SIZE=10000\n")),(0,i.kt)("h3",{id:"encryption"},"Encryption"),(0,i.kt)("p",null,"You can encrypt your backups with AES256 and a password."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell",metastring:'title=".env"',title:'".env"'},"BACKUP_ARCHIVE_PASSWORD=yourPassword\n")),(0,i.kt)("hr",null))}d.isMDXComponent=!0}}]);